<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.wellsky.hhh</groupId>
  <artifactId>hhh-mirth-channels-pbm-test</artifactId>
  <version>${fusion.artifact.version}</version>

  <name>Local-PBM-Test-ADT</name>
  <description>HHH Mirth Project for New PBM Integration</description>

  <properties>

    <!-- The version of this Mirth Channel -->
    <fusion.build.version>0.1</fusion.build.version>

    <!-- BEGIN: Standard properties for a HHH Fusion Maven project -->
    <fusion.artifact.version>${fusion.build.version}-${fusion.build.number.label}</fusion.artifact.version>
    <fusion.resources.generated.dir>${project.build.directory}/generated-resources</fusion.resources.generated.dir>
    <fusion.resources.processed.dir>${project.build.directory}/processed-resources</fusion.resources.processed.dir>
    <fusion.dist.dir>${project.build.directory}/dist</fusion.dist.dir>
    <fusion.dist.zip.basename>${project.artifactId}-${project.version}-dist</fusion.dist.zip.basename>
    <fusion.dist.zip.path>${project.build.directory}/${fusion.dist.zip.basename}.zip</fusion.dist.zip.path>
    <fusion.git.info.format>json</fusion.git.info.format>
    <fusion.git.info.filename>git-info.${fusion.git.info.format}</fusion.git.info.filename>
    <fusion.git.info.generated.file>${fusion.resources.generated.dir}/${fusion.git.info.filename}</fusion.git.info.generated.file>
    <fusion.git.info.processed.file>${fusion.resources.processed.dir}/${fusion.git.info.filename}</fusion.git.info.processed.file>
    <!-- END: Standard properties for each HHH Fusion Maven project -->

    <!-- BEGIN: Standard properties for a HHH Fusion Mirth Channel project -->
    <fusion.dist.resources.dir>${fusion.dist.dir}/mirth-resources</fusion.dist.resources.dir>
    <fusion.dist.channels.dir>${fusion.dist.dir}/mirth-channels</fusion.dist.channels.dir>
    <fusion.dist.configuration.dir>${fusion.dist.dir}/mirth-configuration-map</fusion.dist.configuration.dir>
    <fusion.dist.channels.docs.dir>${fusion.dist.dir}/docs</fusion.dist.channels.docs.dir>
    <fusion.dist.channels.docs.specs.dir>${fusion.dist.channels.docs.dir}/specs</fusion.dist.channels.docs.specs.dir>
    <fusion.channels.source.dir>${project.basedir}/src/main/mirth/channels</fusion.channels.source.dir>
    <fusion.channels.processed.dir>${project.build.directory}/processed-sources/main/mirth/channels</fusion.channels.processed.dir>
    <fusion.channels.configuration.source.dirname>configuration</fusion.channels.configuration.source.dirname>
    <fusion.channels.docs.specs.dir>${fusion.channels.source.dir}/specs</fusion.channels.docs.specs.dir>
    <!-- END: Standard properties for a HHH Fusion Mirth Channel project -->

    <!-- BEGIN: Standard Maven properties local to this Maven project -->
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>1.8</maven.compiler.target>
    <!-- END: Standard Maven properties local to this Maven project -->

    <!-- BEGIN: Properties for HHH Fusion Library Dependencies (in Artifactory Maven Repo) -->

    <!-- hhh-fusion-fhir-profiles-dstu3-java -->
    <hhh.fusion.fhir.profiles.dstu3.java.version>0.8-b6</hhh.fusion.fhir.profiles.dstu3.java.version>
    <hhh.fusion.fhir.profiles.dstu3.java.custom-lib-name>custom-lib-hhh-fusion-fhir-profiles-dstu3-java</hhh.fusion.fhir.profiles.dstu3.java.custom-lib-name>
    <hhh.fusion.fhir.profiles.dstu3.java.custom-lib-dir>${fusion.dist.resources.dir}/${hhh.fusion.fhir.profiles.dstu3.java.custom-lib-name}</hhh.fusion.fhir.profiles.dstu3.java.custom-lib-dir>

    <!-- hhh-fusion-fhir-profiles-validation-dstu3-java -->
    <hhh.fusion.fhir.profiles.validation.dstu3.java.version>0.9-b2</hhh.fusion.fhir.profiles.validation.dstu3.java.version>
    <hhh.fusion.fhir.profiles.validation.dstu3.java.unpack.dir-name>hhh-fusion-fhir-profiles-validation-dstu3-java-${hhh.fusion.fhir.profiles.validation.dstu3.java.version}-dist</hhh.fusion.fhir.profiles.validation.dstu3.java.unpack.dir-name>
    <hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-name>custom-lib-hhh-fusion-fhir-profiles-validation-dstu3-java</hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-name>
    <hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-dir>${fusion.dist.resources.dir}/${hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-name}</hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-dir>

     <!-- hhh-fusion-pbm-support-java -->
    <hhh.fusion.pbm.support.java.version>1.0-b1</hhh.fusion.pbm.support.java.version>
    <hhh.fusion.pbm.support.java.unpack.dir-name>hhh-fusion-pbm-support-java-${hhh.fusion.pbm.support.java.version}-dist</hhh.fusion.pbm.support.java.unpack.dir-name>
    <hhh.fusion.pbm.support.java.custom-lib-name>custom-lib-hhh-fusion-pbm-support-java</hhh.fusion.pbm.support.java.custom-lib-name>
    <hhh.fusion.pbm.support.java.custom-lib-dir>${fusion.dist.resources.dir}/${hhh.fusion.pbm.support.java.custom-lib-name}</hhh.fusion.pbm.support.java.custom-lib-dir>

    <!-- END: Properties for HHH Fusion Library Dependencies (in Artifactory Maven Repo)-->

    <!-- BEGIN: Standard Maven properties local to this Maven project -->
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>1.8</maven.compiler.target>
    <!-- END: Standard Maven properties local to this Maven project -->

  </properties>

  <dependencies>

    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.13.1</version>
      <scope>test</scope>
    </dependency>

    <dependency>
      <groupId>com.wellsky.hhh</groupId>
      <artifactId>hhh-fusion-fhir-profiles-dstu3-java</artifactId>
      <version>${hhh.fusion.fhir.profiles.dstu3.java.version}</version>
    </dependency>

     <dependency>
      <groupId>com.wellsky.hhh</groupId>
      <artifactId>hhh-fusion-fhir-profiles-validation-dstu3-java</artifactId>
      <version>${hhh.fusion.fhir.profiles.validation.dstu3.java.version}</version>
    </dependency>

     <dependency>
      <groupId>com.wellsky.hhh</groupId>
      <artifactId>hhh-fusion-pbm-support-java</artifactId>
      <version>${hhh.fusion.pbm.support.java.version}</version>
    </dependency>

  </dependencies>

  <build>
    <plugins>
      <!-- display active profiles in initialization, package, deploy and install phases -->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-help-plugin</artifactId>
        <version>3.1.1</version>
        <executions>
          <execution>
            <id>show-profiles-package</id>
            <phase>package</phase>
            <goals>
              <goal>active-profiles</goal>
            </goals>
          </execution>
          <execution>
            <id>show-profiles-install</id>
            <phase>install</phase>
            <goals>
              <goal>active-profiles</goal>
            </goals>
          </execution>
          <execution>
            <id>show-profiles-deploy</id>
            <phase>deploy</phase>
            <goals>
              <goal>active-profiles</goal>
            </goals>
          </execution>
          <execution>
            <id>show-profiles-init</id>
            <phase>initialize</phase>
            <goals>
              <goal>active-profiles</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <executions>

          <execution>
            <id>copy-artifact-hhh-fusion-fhir-profiles-dstu3-java</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>copy</goal>
            </goals>
            <configuration>
              <artifactItems>
                <artifactItem>
                  <groupId>com.wellsky.hhh</groupId>
                  <artifactId>hhh-fusion-fhir-profiles-dstu3-java</artifactId>
                  <version>${hhh.fusion.fhir.profiles.dstu3.java.version}</version>
                  <type>jar</type>
                  <overWrite>true</overWrite>
                  <outputDirectory>${hhh.fusion.fhir.profiles.dstu3.java.custom-lib-dir}</outputDirectory>
                </artifactItem>
              </artifactItems>
              <overWriteReleases>true</overWriteReleases>
              <overWriteSnapshots>true</overWriteSnapshots>
            </configuration>
          </execution>

          <execution>
            <id>unpack-dist-artifact-hhh-fusion-fhir-profiles-validation-dstu3-java</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>unpack</goal>
            </goals>
            <configuration>
              <artifactItems>
                <artifactItem>
                  <groupId>com.wellsky.hhh</groupId>
                  <artifactId>hhh-fusion-fhir-profiles-validation-dstu3-java</artifactId>
                  <version>${hhh.fusion.fhir.profiles.validation.dstu3.java.version}</version>
                  <type>zip</type>
                  <classifier>dist</classifier>
                  <overWrite>true</overWrite>
                  <outputDirectory>${project.build.directory}</outputDirectory>
                </artifactItem>
              </artifactItems>
              <overWriteReleases>true</overWriteReleases>
              <overWriteSnapshots>true</overWriteSnapshots>
            </configuration>
          </execution>

            <execution>
            <id>unpack-dist-artifact-hhh-fusion-pbm-support-java</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>unpack</goal>
            </goals>
            <configuration>
              <artifactItems>
                <artifactItem>
                  <groupId>com.wellsky.hhh</groupId>
                  <artifactId>hhh-fusion-pbm-support-java</artifactId>
                  <version>${hhh.fusion.pbm.support.java.version}</version>
                  <type>zip</type>
                  <classifier>dist</classifier>
                  <overWrite>true</overWrite>
                  <outputDirectory>${project.build.directory}</outputDirectory>
                </artifactItem>
              </artifactItems>
              <overWriteReleases>true</overWriteReleases>
              <overWriteSnapshots>true</overWriteSnapshots>
            </configuration>
          </execution>

        </executions>

        <configuration>
          <artifactItems>
            <artifactItem>
              <groupId>com.wellsky.hhh</groupId>
              <artifactId>hhh-fusion-fhir-profiles-dstu3-java</artifactId>
              <version>${hhh.fusion.fhir.profiles.dstu3.java.version}</version>
              <outputDirectory>${hhh.fusion.fhir.profiles.dstu3.java.custom-lib-dir}</outputDirectory>
            </artifactItem>
             <artifactItem>
              <groupId>com.wellsky.hhh</groupId>
              <artifactId>hhh-fusion-fhir-profiles-validation-dstu3-java</artifactId>
              <version>${hhh.fusion.fhir.profiles.validation.dstu3.java.version}</version>
              <outputDirectory>${hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-dir}</outputDirectory>
            </artifactItem>
              <artifactItem>
              <groupId>com.wellsky.hhh</groupId>
              <artifactId>hhh-fusion-pbm-support-java</artifactId>
              <version>${hhh.fusion.pbm.support.java.version}</version>
              <outputDirectory>${hhh.fusion.pbm.support.java.custom-lib-dir}</outputDirectory>
            </artifactItem>
          </artifactItems>
          <overWriteReleases>true</overWriteReleases>
          <overWriteSnapshots>true</overWriteSnapshots>
          <overWriteIfNewer>true</overWriteIfNewer>
          <includeScope>runtime</includeScope>
        </configuration>

      </plugin>


      <plugin>
        <artifactId>maven-resources-plugin</artifactId>
        <executions>
          <execution>
            <id>copy-processed-mirth-channel-files-to-classes-dir</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <resources>
                <resource>
                  <directory>${fusion.channels.processed.dir}</directory>
                  <filtering>false</filtering>
                </resource>
              </resources>
              <outputDirectory>${project.build.outputDirectory}</outputDirectory>
            </configuration>
          </execution>
          <execution>
            <id>copy-mirth-channel-configuration-files-to-classes-dir</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <resources>
                <resource>
                  <directory>${fusion.channels.source.dir}</directory>
                  <includes>
                    <include>${fusion.channels.configuration.source.dirname}/**</include>
                  </includes>
                  <filtering>false</filtering>
                </resource>
              </resources>
              <outputDirectory>${project.build.outputDirectory}</outputDirectory>
            </configuration>
          </execution>
          <execution>
            <id>copy-processed-mirth-channel-files-to-dist-dir</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${fusion.dist.channels.dir}</outputDirectory>
              <overwrite>true</overwrite>
              <resources>
                <resource>
                  <directory>${fusion.channels.processed.dir}</directory>
                  <filtering>false</filtering>
                </resource>
              </resources>
            </configuration>
          </execution>
          <execution>
            <id>copy-mirth-channel-configuration-files-to-dist-dir</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${fusion.dist.configuration.dir}</outputDirectory>
              <overwrite>true</overwrite>
              <resources>
                <resource>
                  <directory>${fusion.channels.source.dir}/${fusion.channels.configuration.source.dirname}</directory>
                  <filtering>false</filtering>
                </resource>
              </resources>
            </configuration>
          </execution>
           <execution>
            <id>copy-mirth-channel-specs-to-dist-dir</id>
            <phase>prepare-package</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${fusion.dist.channels.docs.specs.dir}</outputDirectory>
              <overwrite>true</overwrite>
              <resources>
                <resource>
                  <directory>${fusion.channels.docs.specs.dir}</directory>
                  <filtering>false</filtering>
                </resource>
              </resources>
            </configuration>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <version>1.8</version>
        <executions>

          <execution>
            <id>copy-unpacked-artifact-files-hhh-fusion-fhir-profiles-validation-dstu3-java</id>
            <phase>package</phase>
            <goals>
              <goal>run</goal>
            </goals>
            <configuration>
              <target name="Copying unpacked artifact files for hhh-fusion-fhir-profiles-validation-dstu3-java distribution to channel dist dir">
                <copy toDir="${hhh.fusion.fhir.profiles.validation.dstu3.java.custom-lib-dir}" verbose="true">
                  <fileset dir="${project.build.directory}/${hhh.fusion.fhir.profiles.validation.dstu3.java.unpack.dir-name}" />
                </copy>
              </target>
            </configuration>
          </execution>

          <execution>
            <id>copy-unpacked-artifact-files-hhh-fusion-pbm-support-java</id>
            <phase>package</phase>
            <goals>
              <goal>run</goal>
            </goals>
            <configuration>
              <target name="Copying unpacked artifact files for hhh-fusion-pbm-support-java distribution to channel dist dir">
                <copy toDir="${hhh.fusion.pbm.support.java.custom-lib-dir}" verbose="true">
                  <fileset dir="${project.build.directory}/${hhh.fusion.pbm.support.java.unpack.dir-name}" />
                </copy>
              </target>
            </configuration>
          </execution>

        </executions>
      </plugin>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-assembly-plugin</artifactId>
        <version>3.1.1</version>
        <configuration>
          <appendAssemblyId>false</appendAssemblyId>
          <descriptors>
            <descriptor>src/assembly/assembly-dist.xml</descriptor>
          </descriptors>
          <finalName>${fusion.dist.zip.basename}</finalName>
        </configuration>
        <executions>
          <execution>
            <id>build-dist-zip</id>
            <phase>package</phase>
            <goals>
              <goal>single</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.codehaus.gmaven</groupId>
        <artifactId>groovy-maven-plugin</artifactId>
        <version>2.0</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>execute</goal>
            </goals>
            <configuration>
              <properties>
                <distDir>${fusion.dist.dir}</distDir>
                <jarName>${project.build.directory}/${project.artifactId}-${project.version}.jar</jarName>
                <distZipPath>${fusion.dist.zip.path}</distZipPath>
              </properties>
              <source>
                log.info('')
                log.info('Mirth Channel Source JAR (XML + Config): {}', properties['jarName'].replace("\\", "/"))
                log.info('Mirth Channel Distribution Files       : {}', properties['distDir'].replace("\\", "/"))
                log.info('Mirth Channel Distribution ZIP         : {}', properties['distZipPath'].replace("\\", "/"))
              </source>
            </configuration>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>build-helper-maven-plugin</artifactId>
        <version>3.0.0</version>
        <executions>
          <execution>
            <id>attach-artifacts</id>
            <phase>package</phase>
            <goals>
              <goal>attach-artifact</goal>
            </goals>
            <configuration>
              <artifacts>
                <artifact>
                  <file>${fusion.dist.zip.path}</file>
                  <type>zip</type>
                  <classifier>dist</classifier>
                </artifact>
              </artifacts>
            </configuration>
          </execution>
        </executions>
      </plugin>


      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>versions-maven-plugin</artifactId>
        <version>2.7</version>
        <configuration>
          <includes>
            <include>com.wellsky.hhh:*</include>
          </includes>
          <excludes></excludes>
        </configuration>
      </plugin>
    </plugins>

    <pluginManagement><!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) -->
      <plugins>
        <plugin>
          <artifactId>maven-clean-plugin</artifactId>
          <version>3.1.0</version>
        </plugin>
        <plugin>
          <artifactId>maven-site-plugin</artifactId>
          <version>3.7.1</version>
        </plugin>
        <plugin>
          <artifactId>maven-project-info-reports-plugin</artifactId>
          <version>3.0.0</version>
        </plugin>
        <!-- see http://maven.apache.org/ref/current/maven-core/default-bindings.html#Plugin_bindings_for_jar_packaging -->
        <plugin>
          <artifactId>maven-resources-plugin</artifactId>
          <version>3.1.0</version>
        </plugin>
        <plugin>
          <artifactId>maven-compiler-plugin</artifactId>
          <version>3.8.0</version>
        </plugin>
        <plugin>
          <artifactId>maven-surefire-plugin</artifactId>
          <version>2.22.1</version>
        </plugin>
        <plugin>
          <artifactId>maven-jar-plugin</artifactId>
          <version>3.0.2</version>
        </plugin>
        <plugin>
          <artifactId>maven-install-plugin</artifactId>
          <version>2.5.2</version>
        </plugin>
        <plugin>
          <artifactId>maven-deploy-plugin</artifactId>
          <version>2.8.2</version>
        </plugin>
        <plugin>
          <artifactId>maven-assembly-plugin</artifactId>
          <version>2.4.1</version>
        </plugin>
        <plugin>
          <artifactId>maven-dependency-plugin</artifactId>
          <version>3.1.1</version>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-help-plugin</artifactId>
          <version>3.1.1</version>
        </plugin>
        <plugin>
          <groupId>org.codehaus.mojo</groupId>
          <artifactId>versions-maven-plugin</artifactId>
          <version>2.7</version>
        </plugin>
      </plugins>
    </pluginManagement>
  </build>

  <profiles>

    <profile>
      <id>jenkins-build</id>
      <activation>
        <property>
          <name>env.BUILD_NUMBER</name>
        </property>
      </activation>
      <properties>
        <fusion.build.number>${env.BUILD_NUMBER}</fusion.build.number>
        <fusion.build.number.label>b${env.BUILD_NUMBER}</fusion.build.number.label>
      </properties>
    </profile>

    <profile>
      <id>no-git-repo-detected</id>
      <activation>
        <file>
          <missing>../.git/index</missing>
        </file>
      </activation>
      <properties>
        <fusion.channels.xsl.file>${fusion.channels.source.dir}/xsl/mirth_channel_transform_no_git_info.xsl</fusion.channels.xsl.file>
      </properties>
      <build>
        <plugins>
          <!--
                    <plugin>
                      <artifactId>maven-resources-plugin</artifactId>
                      <executions>
                        <execution>
                          <id>copy-source-mirth-channel-files-to-dist-dir</id>
                          <phase>prepare-package</phase>
                          <goals>
                            <goal>copy-resources</goal>
                          </goals>
                          <configuration>
                            <resources>
                              <resource>
                                <directory>${fusion.channels.source.dir}/Local-PBM-Test-ADT</directory>
                                <filtering>false</filtering>
                              </resource>
                            </resources>
                            <outputDirectory>${fusion.dist.channels.dir}</outputDirectory>
                          </configuration>
                        </execution>
                      </executions>
                    </plugin>
          -->
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>xml-maven-plugin</artifactId>
            <version>1.0.2</version>
            <executions>
              <execution>
                <phase>process-sources</phase>
                <goals>
                  <goal>transform</goal>
                </goals>
              </execution>
            </executions>
            <configuration>
              <transformationSets>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-ADT</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-ADT/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-OMP</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-OMP/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-ADT</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-ADT/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-OMP</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-OMP/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
              </transformationSets>
            </configuration>
            <dependencies>
              <dependency>
                <groupId>net.sf.saxon</groupId>
                <artifactId>saxon</artifactId>
                <version>8.7</version>
              </dependency>
            </dependencies>
          </plugin>

        </plugins>
      </build>
    </profile>

    <profile>
      <id>git-repo-detected</id>
      <activation>
        <file>
          <exists>../.git/index</exists>
        </file>
      </activation>
      <properties>
        <fusion.channels.xsl.file>${fusion.channels.source.dir}/xsl/mirth_channel_transform_git_info.xsl</fusion.channels.xsl.file>
      </properties>
      <build>
        <plugins>

          <plugin>
            <groupId>pl.project13.maven</groupId>
            <artifactId>git-commit-id-plugin</artifactId>
            <version>2.2.5</version>
            <executions>
              <execution>
                <id>inspect-git-repo-info</id>
                <goals>
                  <goal>revision</goal>
                </goals>
                <phase>initialize</phase>
              </execution>
              <execution>
                <id>validate-the-git-repo-info</id>
                <goals>
                  <goal>validateRevision</goal>
                </goals>
                <phase>compile</phase>
              </execution>
            </executions>
            <configuration>
              <dotGitDirectory>${project.basedir}/.git</dotGitDirectory>
              <failOnNoGitDirectory>false</failOnNoGitDirectory>
              <generateGitPropertiesFile>true</generateGitPropertiesFile>
              <generateGitPropertiesFilename>${fusion.git.info.generated.file}</generateGitPropertiesFilename>
              <format>${fusion.git.info.format}</format>
              <prefix>git</prefix>
              <gitDescribe>
                <abbrev>7</abbrev>
              </gitDescribe>
            </configuration>
          </plugin>

          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>xml-maven-plugin</artifactId>
            <version>1.0.2</version>
            <executions>
              <execution>
                <phase>process-sources</phase>
                <goals>
                  <goal>transform</goal>
                </goals>
              </execution>
            </executions>
            <configuration>
              <transformationSets>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-ADT</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-ADT/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildVersion</name>
                      <value>${git.build.version}</value>
                    </parameter>
                    <parameter>
                      <name>gitBranch</name>
                      <value>${git.branch}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildHost</name>
                      <value>${git.build.host}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildTime</name>
                      <value>${git.build.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserName</name>
                      <value>${git.build.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserEmail</name>
                      <value>${git.build.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitId</name>
                      <value>${git.commit.id}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitIdDescribeShort</name>
                      <value>${git.commit.id.describe-short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitMessageShort</name>
                      <value>${git.commit.message.short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitTime</name>
                      <value>${git.commit.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserName</name>
                      <value>${git.commit.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserEmail</name>
                      <value>${git.commit.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitRemoteOriginUrl</name>
                      <value>${git.remote.origin.url}</value>
                    </parameter>
                    <parameter>
                      <name>gitTags</name>
                      <value>${git.tags}</value>
                    </parameter>
                    <parameter>
                      <name>gitTotalCommitCount</name>
                      <value>${git.total.commit.count}</value>
                    </parameter>
                    <parameter>
                      <name>gitDirty</name>
                      <value>${git.dirty}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-OMP</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-OMP/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildVersion</name>
                      <value>${git.build.version}</value>
                    </parameter>
                    <parameter>
                      <name>gitBranch</name>
                      <value>${git.branch}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildHost</name>
                      <value>${git.build.host}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildTime</name>
                      <value>${git.build.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserName</name>
                      <value>${git.build.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserEmail</name>
                      <value>${git.build.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitId</name>
                      <value>${git.commit.id}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitIdDescribeShort</name>
                      <value>${git.commit.id.describe-short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitMessageShort</name>
                      <value>${git.commit.message.short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitTime</name>
                      <value>${git.commit.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserName</name>
                      <value>${git.commit.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserEmail</name>
                      <value>${git.commit.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitRemoteOriginUrl</name>
                      <value>${git.remote.origin.url}</value>
                    </parameter>
                    <parameter>
                      <name>gitTags</name>
                      <value>${git.tags}</value>
                    </parameter>
                    <parameter>
                      <name>gitTotalCommitCount</name>
                      <value>${git.total.commit.count}</value>
                    </parameter>
                    <parameter>
                      <name>gitDirty</name>
                      <value>${git.dirty}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
                 <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-ADT</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-ADT/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildVersion</name>
                      <value>${git.build.version}</value>
                    </parameter>
                    <parameter>
                      <name>gitBranch</name>
                      <value>${git.branch}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildHost</name>
                      <value>${git.build.host}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildTime</name>
                      <value>${git.build.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserName</name>
                      <value>${git.build.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserEmail</name>
                      <value>${git.build.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitId</name>
                      <value>${git.commit.id}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitIdDescribeShort</name>
                      <value>${git.commit.id.describe-short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitMessageShort</name>
                      <value>${git.commit.message.short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitTime</name>
                      <value>${git.commit.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserName</name>
                      <value>${git.commit.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserEmail</name>
                      <value>${git.commit.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitRemoteOriginUrl</name>
                      <value>${git.remote.origin.url}</value>
                    </parameter>
                    <parameter>
                      <name>gitTags</name>
                      <value>${git.tags}</value>
                    </parameter>
                    <parameter>
                      <name>gitTotalCommitCount</name>
                      <value>${git.total.commit.count}</value>
                    </parameter>
                    <parameter>
                      <name>gitDirty</name>
                      <value>${git.dirty}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
                <transformationSet>
                  <dir>${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-OMP</dir>
                  <stylesheet>${fusion.channels.xsl.file}</stylesheet>
                  <includes>
                    <include>*.xml</include>
                  </includes>
                  <outputDir>${fusion.channels.processed.dir}</outputDir>
                  <parameters>
                    <parameter>
                      <name>channelDescriptionFile</name>
                      <value>file:///${fusion.channels.source.dir}/Local-PBM-Test-ADT-Validation-OMP/channel_description.txt</value>
                    </parameter>
                    <parameter>
                      <name>groupId</name>
                      <value>${project.groupId}</value>
                    </parameter>
                    <parameter>
                      <name>artifactId</name>
                      <value>${project.artifactId}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildVersion</name>
                      <value>${git.build.version}</value>
                    </parameter>
                    <parameter>
                      <name>gitBranch</name>
                      <value>${git.branch}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildHost</name>
                      <value>${git.build.host}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildTime</name>
                      <value>${git.build.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserName</name>
                      <value>${git.build.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitBuildUserEmail</name>
                      <value>${git.build.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitId</name>
                      <value>${git.commit.id}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitIdDescribeShort</name>
                      <value>${git.commit.id.describe-short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitMessageShort</name>
                      <value>${git.commit.message.short}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitTime</name>
                      <value>${git.commit.time}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserName</name>
                      <value>${git.commit.user.name}</value>
                    </parameter>
                    <parameter>
                      <name>gitCommitUserEmail</name>
                      <value>${git.commit.user.email}</value>
                    </parameter>
                    <parameter>
                      <name>gitRemoteOriginUrl</name>
                      <value>${git.remote.origin.url}</value>
                    </parameter>
                    <parameter>
                      <name>gitTags</name>
                      <value>${git.tags}</value>
                    </parameter>
                    <parameter>
                      <name>gitTotalCommitCount</name>
                      <value>${git.total.commit.count}</value>
                    </parameter>
                    <parameter>
                      <name>gitDirty</name>
                      <value>${git.dirty}</value>
                    </parameter>
                  </parameters>
                </transformationSet>
              </transformationSets>
            </configuration>
            <dependencies>
              <dependency>
                <groupId>net.sf.saxon</groupId>
                <artifactId>saxon</artifactId>
                <version>8.7</version>
              </dependency>
            </dependencies>
          </plugin>

          <plugin>
            <artifactId>maven-resources-plugin</artifactId>
            <executions>
              <execution>
                <id>process-git-info-file</id>
                <phase>prepare-package</phase>
                <goals>
                  <goal>resources</goal>
                </goals>
                <configuration>
                  <useDefaultDelimiters>true</useDefaultDelimiters>
                  <resources>
                    <resource>
                      <directory>${fusion.resources.generated.dir}</directory>
                      <includes>
                        <include>${fusion.git.info.filename}</include>
                      </includes>
                      <filtering>true</filtering>
                    </resource>
                  </resources>
                  <outputDirectory>${fusion.resources.processed.dir}</outputDirectory>
                </configuration>
              </execution>
            </executions>
          </plugin>

          <plugin>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.8</version>
            <executions>
              <execution>
                <id>copy-processed-git-info-file-to-dist-dir</id>
                <phase>package</phase>
                <goals>
                  <goal>run</goal>
                </goals>
                <configuration>
                  <target name="Copying processed git-info file to channel dist dir">
                    <copy toDir="${fusion.dist.dir}" verbose="true">
                      <fileset dir="${fusion.resources.processed.dir}">
                        <include name="${fusion.git.info.filename}"/>
                      </fileset>
                    </copy>
                  </target>
                </configuration>
              </execution>
              <execution>
                <id>copy-processed-git-info-file-to-classes-dir</id>
                <phase>package</phase>
                <goals>
                  <goal>run</goal>
                </goals>
                <configuration>
                  <target name="Copying processed git-info file to classes-dir">
                    <copy toDir="${project.build.directory}/classes" verbose="true">
                      <fileset dir="${fusion.resources.processed.dir}">
                        <include name="${fusion.git.info.filename}"/>
                      </fileset>
                    </copy>
                  </target>
                </configuration>
              </execution>
            </executions>
          </plugin>

        </plugins>
      </build>
    </profile>
    <profile>
      <id>local-build</id>
      <activation>
        <property>
          <name>!env.BUILD_NUMBER</name>
        </property>
      </activation>
      <properties>
        <fusion.build.number>LOCAL-SNAPSHOT</fusion.build.number> <!-- Default if  env var BUILD_NUMBER is not defined (i.e. not a Jenkins build) -->
        <!--suppress UnresolvedMavenProperty -->
        <fusion.build.number.label>${fusion.build.number}</fusion.build.number.label> <!-- Default if env var BUILD_NUMBER is not defined (i.e. not a Jenkins build) -->
      </properties>

      <!-- See docs/dev-docs/HHH-Artifactory-Setup-Howto.md for how to add your HHH Artifactory account credentials
           to your Maven settings file (~/.m2/settings.xml) for use by Maven when accessing the HHH Artifactory repos defined
       -->
      <repositories>
        <repository>
          <id>central</id>
          <url>http://repo1.maven.org/maven2</url>
          <releases>
          </releases>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
        </repository>
        <repository>
          <id>artifactory-hhh-libs-release-local</id>
          <releases>
          </releases>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <name>hhh-libs-release-local</name>
          <url>http://dev-artifactory.austin.kinnser.com/artifactory/hhh-libs-release-local</url>
        </repository>
        <repository>
          <id>artifactory-hhh-libs-snapshot-local</id>
          <releases>
            <enabled>false</enabled>
          </releases>
          <snapshots>
          </snapshots>
          <name>hhh-libs-snapshot-local</name>
          <url>http://dev-artifactory.austin.kinnser.com/artifactory/hhh-libs-snapshot-local</url>
        </repository>
      </repositories>
      <pluginRepositories>
        <pluginRepository>
          <id>central</id>
          <url>http://repo1.maven.org/maven2</url>
          <releases>
          </releases>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
        </pluginRepository>
        <pluginRepository>
          <id>artifactory-hhh-libs-release-local</id>
          <releases>
          </releases>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <name>hhh-libs-release-local</name>
          <url>http://dev-artifactory.austin.kinnser.com/artifactory/hhh-libs-release-local</url>
        </pluginRepository>
        <pluginRepository>
          <id>artifactory-hhh-libs-snapshot-local</id>
          <releases>
            <enabled>false</enabled>
          </releases>
          <snapshots>
          </snapshots>
          <name>hhh-libs-snapshot-local</name>
          <url>http://dev-artifactory.austin.kinnser.com/artifactory/hhh-libs-snapshot-local</url>
        </pluginRepository>
      </pluginRepositories>
    </profile>
  </profiles>
</project>
